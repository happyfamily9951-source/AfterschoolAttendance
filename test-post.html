<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Test GAS API</title>
</head>
<body>
  <h2> Test Google Sheet Write </h2>
  <button onclick="sendData()">Send Test POST Data</button>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbxFkuQYbOMbJIEjM51wtLxBQkHtvOosw5g0Oa7-B-WixMNSP5gVIauQ2ccCzsq3jBiw/exec";

    async function sendData() {

      const records = [
        {studentId: "S001", studentName: "Alice", gender: "F", status: "Present", notes: ""},
        {studentId: "S002", studentName: "Bob", gender: "M", status: "Absent", notes: "Sick"},
        {studentId: "S003", studentName: "Charlie", gender: "M", status: "Leave", notes: "Travel"}
        ];
      
      const body = 
        "action=addTest" +
        "&name=" + encodeURIComponent("Alice") +
        "&note=" + encodeURIComponent(JSON.stingify(records)); 
      
      try {
        const response = await fetch(API_URL, {
          method: "POST",
          headers: {"Content-Type": "application/x-www-form-urlencoded"},
          body: body
        });
        
        const result = await response.json();
        console.log("返回结果:", result);
        alert(JSON.stringify(result));
      } catch (err) {
        console.error("Bad request: ", err);
        alert("Error: " + err.message);
      }
    }    
  </script>
</body>
</html>
